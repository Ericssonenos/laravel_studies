### Configuração de Variáveis
@baseUrl = http://localhost:8080/api/auth
@contentType = application/json
@timestamp = {{$timestamp}}
@guid = {{$guid}}

### ========================================
### CENÁRIO 1: PADARIA DO JOÃO (Empresa Pequena)
### ========================================

#[ ] FALTA CRIAR O CRUD DO LOCATÁRIO
### 1.1. Cadastrar Locatário: Padaria do João
# @name criarLocatarioPadaria
POST {{baseUrl}}/locatarios HTTP/1.1
Content-Type: {{contentType}}
{
    "txt_nome_locatario": "Padaria do João",
    "txt_identificador_locatario": "padaria-joao",
    "txt_descricao_locatario": "Padaria familiar tradicional",
    "flg_ativo_locatario": true
}

### 1.2. Criar Grupos da Padaria
# Grupo: Administradores
# @name grupoAdminPadaria
POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "txt_nome_grupo": "Administradores",
    "txt_descricao_grupo": "Proprietários e sócios da padaria",
    "flg_ativo_grupo": true
}

### Grupo: Funcionários
# @name grupoFuncionariosPadaria
POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "txt_nome_grupo": "Funcionários",
    "txt_descricao_grupo": "Funcionários operacionais da padaria",
    "flg_ativo_grupo": true
}

### 1.3. Criar Papéis da Padaria
# Papel: Proprietário
# @name papelProprietario
POST {{baseUrl}}/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "txt_nome_papel": "Proprietário",
    "num_nivel_papel": 10,
    "flg_ativo_papel": true
}

### Papel: Funcionário
# @name papelFuncionario
POST {{baseUrl}}/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "txt_nome_papel": "Funcionário",
    "num_nivel_papel": 1,
    "flg_ativo_papel": true
}

### 1.4. Criar Permissões da Padaria
# Permissão: Ver Vendas
POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "ver_vendas",
    "txt_descricao_permissao": "Visualizar relatórios de vendas",
    "flg_ativo_permissao": true
}

### Permissão: Criar Produto
POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "criar_produto",
    "txt_descricao_permissao": "Cadastrar novos produtos",
    "flg_ativo_permissao": true
}

### Permissão: Registrar Venda
POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "registrar_venda",
    "txt_descricao_permissao": "Registrar vendas no sistema",
    "flg_ativo_permissao": true
}

### 1.5. Cadastrar Usuários da Padaria
# João (Dono)
# @name joaoDono
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "txt_nome_usuario": "João Santos",
    "txt_email_usuario": "joao.dono@padaria.com",
    "txt_senha_usuario": "MinhaSenh@123",
    "flg_ativo_usuario": true
}

### Maria (Caixa)
# @name mariaCaixa
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "txt_nome_usuario": "Maria Silva",
    "txt_email_usuario": "maria.caixa@padaria.com",
    "txt_senha_usuario": "SenhaForte456!",
    "flg_ativo_usuario": true
}

### Pedro (Padeiro)
# @name pedroPadeiro
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "txt_nome_usuario": "Pedro Oliveira",
    "txt_email_usuario": "pedro.padeiro@padaria.com",
    "txt_senha_usuario": "PedroPão2024@",
    "flg_ativo_usuario": true
}

### 1.6. Atribuir Grupos aos Usuários
# João ao grupo Administradores
POST {{baseUrl}}/usuarios/1/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 1
}

### Maria ao grupo Funcionários
POST {{baseUrl}}/usuarios/2/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 2
}

### Pedro ao grupo Funcionários
POST {{baseUrl}}/usuarios/3/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 2
}

### 1.7. Atribuir Papéis aos Usuários
# João como Proprietário
POST {{baseUrl}}/usuarios/1/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "papel_id": 1
}

### Maria como Funcionário
POST {{baseUrl}}/usuarios/2/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "papel_id": 2
}

### Pedro como Funcionário
POST {{baseUrl}}/usuarios/3/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "papel_id": 2
}

### ========================================
### CENÁRIO 2: TECHCORP SOLUTIONS (Empresa Média)
### ========================================

### 2.1. Cadastrar Locatário: TechCorp
# @name criarLocatarioTech
POST {{baseUrl}}/locatarios HTTP/1.1
Content-Type: {{contentType}}

{
    "txt_nome_locatario": "TechCorp Solutions",
    "txt_identificador_locatario": "techcorp",
    "txt_descricao_locatario": "Empresa de tecnologia e desenvolvimento de software",
    "flg_ativo_locatario": true
}

### 2.2. Criar Grupos por Departamento
# Grupo: TI
POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_grupo": "TI",
    "txt_descricao_grupo": "Departamento de Tecnologia da Informação",
    "flg_ativo_grupo": true
}

### Grupo: RH
POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_grupo": "RH",
    "txt_descricao_grupo": "Departamento de Recursos Humanos",
    "flg_ativo_grupo": true
}

### Grupo: Vendas
POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_grupo": "Vendas",
    "txt_descricao_grupo": "Departamento Comercial e Vendas",
    "flg_ativo_grupo": true
}

### Grupo: Financeiro
POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_grupo": "Financeiro",
    "txt_descricao_grupo": "Departamento Financeiro e Contábil",
    "flg_ativo_grupo": true
}

### 2.3. Criar Papéis Hierárquicos
# Papel: CEO
POST {{baseUrl}}/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_papel": "CEO",
    "num_nivel_papel": 100,
    "flg_ativo_papel": true
}

### Papel: Diretor
POST {{baseUrl}}/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_papel": "Diretor",
    "num_nivel_papel": 50,
    "flg_ativo_papel": true
}

### Papel: Gerente
POST {{baseUrl}}/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_papel": "Gerente",
    "num_nivel_papel": 25,
    "flg_ativo_papel": true
}

### Papel: Analista
POST {{baseUrl}}/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_papel": "Analista",
    "num_nivel_papel": 10,
    "flg_ativo_papel": true
}

### 2.4. Criar Permissões por Módulo
# Módulo Financeiro
POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "ver_relatorios",
    "txt_descricao_permissao": "Visualizar relatórios financeiros",
    "flg_ativo_permissao": true
}

POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "aprovar_despesas",
    "txt_descricao_permissao": "Aprovar despesas e investimentos",
    "flg_ativo_permissao": true
}

### Módulo RH
POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "contratar",
    "txt_descricao_permissao": "Contratar novos funcionários",
    "flg_ativo_permissao": true
}

POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "demitir",
    "txt_descricao_permissao": "Demitir funcionários",
    "flg_ativo_permissao": true
}

POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "avaliar",
    "txt_descricao_permissao": "Avaliar desempenho de funcionários",
    "flg_ativo_permissao": true
}

### Módulo TI
POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "deploy",
    "txt_descricao_permissao": "Fazer deploy de aplicações",
    "flg_ativo_permissao": true
}

POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "backup",
    "txt_descricao_permissao": "Gerenciar backups do sistema",
    "flg_ativo_permissao": true
}

POST {{baseUrl}}/permissoes HTTP/1.1
Content-Type: {{contentType}}

{
    "cod_permissao": "configurar",
    "txt_descricao_permissao": "Configurar sistemas e serviços",
    "flg_ativo_permissao": true
}

### 2.5. Cadastrar Usuários TechCorp
# Carlos (CEO)
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_usuario": "Carlos Alberto",
    "txt_email_usuario": "carlos.ceo@techcorp.com",
    "txt_senha_usuario": "CEOSeguro2024!",
    "flg_ativo_usuario": true
}

### Ana (Diretora de RH)
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_usuario": "Ana Santos",
    "txt_email_usuario": "ana.rh@techcorp.com",
    "txt_senha_usuario": "AnaDiretora123@",
    "flg_ativo_usuario": true
}

### Ricardo (Gerente de TI)
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_usuario": "Ricardo Silva",
    "txt_email_usuario": "ricardo.ti@techcorp.com",
    "txt_senha_usuario": "RicardoTI456!",
    "flg_ativo_usuario": true
}

### Juliana (Analista Financeiro)
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_usuario": "Juliana Costa",
    "txt_email_usuario": "juliana.financeiro@techcorp.com",
    "txt_senha_usuario": "JuFinancas789@",
    "flg_ativo_usuario": true
}

### 2.6. Configurar Relacionamentos TechCorp
# Carlos: CEO no grupo Financeiro (para ter visão geral)
POST {{baseUrl}}/usuarios/4/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 6
}

POST {{baseUrl}}/usuarios/4/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "papel_id": 5
}

### Ana: Diretora no grupo RH
POST {{baseUrl}}/usuarios/5/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 4
}

POST {{baseUrl}}/usuarios/5/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "papel_id": 6
}

### Ricardo: Gerente no grupo TI
POST {{baseUrl}}/usuarios/6/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 3
}

POST {{baseUrl}}/usuarios/6/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "papel_id": 7
}

### Juliana: Analista no grupo Financeiro
POST {{baseUrl}}/usuarios/7/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 6
}

POST {{baseUrl}}/usuarios/7/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "papel_id": 8
}

### ========================================
### CENÁRIO 3: ONBOARDING DE NOVO FUNCIONÁRIO
### ========================================

### 3.1. Cadastrar Novo Funcionário TechCorp
# Lucas (Desenvolvedor Junior)
# @name lucasDesenvolvedor
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_usuario": "Lucas Pereira",
    "txt_email_usuario": "lucas.dev@techcorp.com",
    "txt_senha_usuario": "LucasDev2024!",
    "flg_ativo_usuario": true
}

### 3.2. Adicionar aos Grupos Apropriados
# Grupo TI
POST {{baseUrl}}/usuarios/8/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 3
}

### Grupo Novatos (criar primeiro)
POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_grupo": "Novatos",
    "txt_descricao_grupo": "Funcionários em período de experiência",
    "flg_ativo_grupo": true
}

### Adicionar Lucas ao grupo Novatos
POST {{baseUrl}}/usuarios/8/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 7
}

### 3.3. Atribuir Papel Baseado na Função
POST {{baseUrl}}/usuarios/8/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "papel_id": 8
}

### 3.4. Verificar Permissões Herdadas
# Listar grupos do Lucas
GET {{baseUrl}}/usuarios/8/grupos HTTP/1.1

### Listar papéis do Lucas
GET {{baseUrl}}/usuarios/8/papeis HTTP/1.1

### Listar permissões do Lucas
GET {{baseUrl}}/usuarios/8/permissoes HTTP/1.1

### ========================================
### CENÁRIO 4: E-COMMERCE DEMO
### ========================================

### 4.1. Cadastrar Locatário E-commerce
POST {{baseUrl}}/locatarios HTTP/1.1
Content-Type: {{contentType}}

{
    "txt_nome_locatario": "MegaStore Online",
    "txt_identificador_locatario": "megastore",
    "txt_descricao_locatario": "Plataforma de e-commerce completa",
    "flg_ativo_locatario": true
}

### 4.2. Grupos por Função
POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 3,
    "txt_nome_grupo": "Marketing",
    "txt_descricao_grupo": "Equipe de marketing digital",
    "flg_ativo_grupo": true
}

POST {{baseUrl}}/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 3,
    "txt_nome_grupo": "Logística",
    "txt_descricao_grupo": "Equipe de estoque e entregas",
    "flg_ativo_grupo": true
}

### 4.3. Papéis Operacionais
POST {{baseUrl}}/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 3,
    "txt_nome_papel": "Operador",
    "num_nivel_papel": 5,
    "flg_ativo_papel": true
}

POST {{baseUrl}}/papeis HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 3,
    "txt_nome_papel": "Coordenador",
    "num_nivel_papel": 15,
    "flg_ativo_papel": true
}

### 4.4. Usuários E-commerce
# Fernanda (Marketing)
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 3,
    "txt_nome_usuario": "Fernanda Lima",
    "txt_email_usuario": "fernanda.marketing@megastore.com",
    "txt_senha_usuario": "FernandaMarketing2024!",
    "flg_ativo_usuario": true
}

### Roberto (Logística)
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 3,
    "txt_nome_usuario": "Roberto Santos",
    "txt_email_usuario": "roberto.logistica@megastore.com",
    "txt_senha_usuario": "RobertoLog456@",
    "flg_ativo_usuario": true
}

### ========================================
### TESTES DE VALIDAÇÃO
### ========================================

### 5.1. Teste: Email Duplicado
POST {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "txt_nome_usuario": "João Duplicado",
    "txt_email_usuario": "joao.dono@padaria.com",
    "txt_senha_usuario": "SenhaDuplicada123!",
    "flg_ativo_usuario": true
}

### 5.2. Teste: Usuário em Locatário Errado
POST {{baseUrl}}/usuarios/1/grupos HTTP/1.1
Content-Type: {{contentType}}

{
    "grupo_id": 3
}

### 5.3. Teste: Consulta Cross-Tenant
# Tentar ver usuários de outro locatário
GET {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_usuario": "João"
}

### ========================================
### CONSULTAS DE VERIFICAÇÃO
### ========================================

### 6.1. Verificar Estrutura Padaria
GET {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 1,
    "order_by": "txt_nome_usuario ASC",
    "txt_teste": "teste"
}

### 6.2. Verificar Estrutura TechCorp
GET {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "order_by": "dat_criado_em DESC",
    "limit": 10
}

### 6.3. Buscar por Departamento
GET {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "locatario_id": 2,
    "txt_nome_usuario": "TI"
}

### 6.4. Verificar Usuários Ativos
GET {{baseUrl}}/usuarios HTTP/1.1
Content-Type: {{contentType}}

{
    "flg_ativo_usuario": true,
    "order_by": "locatario_id ASC, txt_nome_usuario ASC"
}
